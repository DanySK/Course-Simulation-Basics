official-repo: &official-repo
  DanySK/Course-Simulation-Basics
language: java
addons:
  apt:
    update: true
    packages:
      # LaTeX decent font processor
      - cm-super
      # LaTeX base packages
      - texlive-latex-base
      - texlive-fonts-recommended
      - texlive-fonts-extra
      - texlive-latex-extra
      # For Minted
      - python-pygments
      # Debug
      - tree
      - apt-file
env:
  global:
    - TERM=dumb
    - GRAVIS="https://raw.githubusercontent.com/DanySK/Gravis-CI/master/"
install:
  - sudo apt-get install $(cat requirements.txt | awk '{print}' ORS=' ')
script: ./gradlew buildLatex
after_failure:
  - tree
  - sudo apt-file update
  - apt-file find italian.ldf # Replace with the name of the a missing file
before_deploy:
  - git config --local user.name "Danilo Pianini"
  - git config --local user.email "danilo.pianini@unibo.it"
  - if [[ $(git describe) == *"-"* ]]; then git tag $(git describe) || :; fi
before_cache:
  - curl "${GRAVIS}.clean_gradle_cache.sh" --output .clean_gradle_cache.sh
  - bash .clean_gradle_cache.sh
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
deploy:
  - provider: releases
    api_key:
      secure: "L2P6A4W0CPFY2wDux0j0b+VHsP8MoZ7MY84n+tcTSsnBmxTSufs+2MBq7ophM4eLkk1Ug4y5ab4CgegRd0vs4FbCkGqp7viBNstX+uHak+0fDxRp7+j4ySmY+sDODY0tW79lYvKYHF4AalJ6j6d9Bh4PHEb3XOlCQV3VzZlCQJ6o5TXR3HCxXu8cgAxDbi8/KUYnSuBMRJN17+jm3FkhFEGYd4XacpCpZkKY9g/QcA38CgBH9CZLEEeQ5Xux9XovLkbMFn8a/jZW7RVddMkRIunG/hpG5PDMWYq7sQxGDDLX1DODu1VRNVVGiy3MC+uwhqgeEIUT76jjOVDsGL2/obYMN+3EIOK6ltBrG9ZOa4yrgmudV75BFYA/Vsq6UC5nxdC4507nXY/d1G/wQY0Kw6hezJNlYrmxKzaCnFbbDIYYtZl+K0zzXaRMN7RaQk8m24wS+qR5FpLcS6kG7r/TkRpqz+5qXUSTqcUSTOKUoLGPGdwMGYzQYgL8ejFZnYHMh380ZQ9GJfK9eR713Vsm0bqeb0rJkiIrl2ElE+6Zc0g8DikwAdoIh+ncwANla47K7YnZt/MOAhgpUtsKgY3LmTibLfs7KdxanFVqQyOTueltczbF1FMMc/V/Pdlt2WmW9BASGMlbiz41No28t4HQ3+XUalbJF2Kxu6ZTJwNflRA="
    file_glob: true
    file: "*.pdf"
    skip_cleanup: true
    on:
      repo: *official-repo
      tags: true
  - provider: releases
    api_key:
      secure: "L2P6A4W0CPFY2wDux0j0b+VHsP8MoZ7MY84n+tcTSsnBmxTSufs+2MBq7ophM4eLkk1Ug4y5ab4CgegRd0vs4FbCkGqp7viBNstX+uHak+0fDxRp7+j4ySmY+sDODY0tW79lYvKYHF4AalJ6j6d9Bh4PHEb3XOlCQV3VzZlCQJ6o5TXR3HCxXu8cgAxDbi8/KUYnSuBMRJN17+jm3FkhFEGYd4XacpCpZkKY9g/QcA38CgBH9CZLEEeQ5Xux9XovLkbMFn8a/jZW7RVddMkRIunG/hpG5PDMWYq7sQxGDDLX1DODu1VRNVVGiy3MC+uwhqgeEIUT76jjOVDsGL2/obYMN+3EIOK6ltBrG9ZOa4yrgmudV75BFYA/Vsq6UC5nxdC4507nXY/d1G/wQY0Kw6hezJNlYrmxKzaCnFbbDIYYtZl+K0zzXaRMN7RaQk8m24wS+qR5FpLcS6kG7r/TkRpqz+5qXUSTqcUSTOKUoLGPGdwMGYzQYgL8ejFZnYHMh380ZQ9GJfK9eR713Vsm0bqeb0rJkiIrl2ElE+6Zc0g8DikwAdoIh+ncwANla47K7YnZt/MOAhgpUtsKgY3LmTibLfs7KdxanFVqQyOTueltczbF1FMMc/V/Pdlt2WmW9BASGMlbiz41No28t4HQ3+XUalbJF2Kxu6ZTJwNflRA="
    file_glob: true
    file: "*.pdf"
    skip_cleanup: true
    on:
      repo: *official-repo
      tags: false
